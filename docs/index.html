<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset='utf-8'>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width,maximum-scale=2" name="viewport">
    <link href="/state-store/assets/css/style.css?v=7d8890763e9d62eef203a183b3db9a69ff41204f" media="screen"
          rel="stylesheet"
          type="text/css">

    <!-- Begin Jekyll SEO tag v2.6.1 -->
    <title>ngx-state-store | state-store</title>
    <meta content="Jekyll v3.9.0" name="generator"/>
    <meta content="ngx-state-store" property="og:title"/>
    <meta content="en_US" property="og:locale"/>
    <meta content="Sample application for the ngx-state-store module usage features demonstration." name="description"/>
    <meta content="Sample application for the ngx-state-store module usage features demonstration."
          property="og:description"/>
    <link href="https://it-and-services.github.io/state-store/" rel="canonical"/>
    <meta content="https://it-and-services.github.io/state-store/" property="og:url"/>
    <meta content="state-store" property="og:site_name"/>
    <script type="application/ld+json">
        {
            "@type": "WebSite",
            "headline": "ngx-state-store",
            "url": "https://it-and-services.github.io/state-store/",
            "description": "Sample application for the ngx-state-store module usage features demonstration.",
            "name": "state-store",
            "@context": "https://schema.org"
        }</script>
    <!-- End Jekyll SEO tag -->

</head>

<body>

<!-- HEADER -->
<div class="outer" id="header_wrap">
    <header class="inner">
        <a href="https://github.com/it-and-services/state-store" id="forkme_banner">View on GitHub</a>

        <h1 id="project_title">state-store</h1>
        <h2 id="project_tagline">Sample application for the ngx-state-store module usage features demonstration.</h2>


    </header>
</div>

<!-- MAIN CONTENT -->
<div class="outer" id="main_content_wrap">
    <section class="inner" id="main_content" style="max-width: 960px">
        <h1 id="ngx-state-store">ngx-state-store</h1>
        <p>ngx-state-store is the state management module for the angular applications starting from the angular version
            &gt;= 7.2.0</p>

        <h2 id="state-store">state-store</h2>
        <p>Sample application for the ngx-state-store module usage features demonstration.<br/>
            The sample application solely concentrated on the ngx-state-store usage features.</p>

        <p>IT IS NOT ABOUT THE ARCHITECTURE OF AN APPLICATION.</p>

        <p>Sourcecode examples are available at <a href="https://github.com/it-and-services/state-store">https://github.com/it-and-services/state-store</a>.
        </p>

        <p>This project was generated with <a href="https://github.com/angular/angular-cli">Angular CLI</a> version
            11.0.2.</p>

        <h5 id="content">Content:</h5>
        <p><a href="#1-usage-description-of-the-ngx-state-store-module">1. Usage description of the ngx-state-store
            module.</a><br/>
            <a href="#2-more-complex-use-case-with-the-back-end-call">2. More complex use case with the back-end
                call.</a><br/>
            <a href="#3-api-overview">3. API overview.</a><br/>
            <a href="https://it-and-services.github.io/state-store/app.html"
               target="_blank" title="StateStore App example">4. StateStore App example.</a></p>

        <h3 id="1-usage-description-of-the-ngx-state-store-module">1. Usage description of the ngx-state-store
            module.</h3>

        <h5 id="11-create-a-state-object">1.1. Create a state object.</h5>
        <p>Example: src/app/services/state-store/app-state.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span
                    class="kd">class</span> <span class="nx">AppState</span> <span class="p">{</span>
  <span class="nl">Counter</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="12-create-an-initial-state-object">1.2. Create an initial state object.</h5>
        <p>Example: src/app/services/state-store/app-initial-state.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">./app-state</span><span class="dl">'</span><span
                    class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">AppInitialState</span><span
                        class="p">:</span> <span class="nx">AppState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">Counter</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">};</span>
</code></pre>
            </div>
        </div>

        <h5 id="13-register-the-ngxstatestoremodule-in-srcappappmodulets">1.3. Register the NgxStateStoreModule in
            src/app/app.module.ts</h5>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppInitialState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">./services/state-store/app-initial-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">NgxStateStoreModule</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">// ...</span>
  <span class="p">],</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">// ...</span>
    <span class="nx">NgxStateStoreModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">({</span>
      <span class="na">storeName</span><span class="p">:</span> <span class="dl">'</span><span
                        class="s1">store-demo</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">log</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">timekeeping</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">initialState</span><span class="p">:</span> <span class="nx">AppInitialState</span>
    <span class="p">}),</span>
    <span class="c1">// ...</span>
  <span class="p">],</span>
  <span class="c1">// ...</span>
<span class="p">})</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <p>At run time you can access the store in the console by the path <code
                class="language-plaintext highlighter-rouge">window['ngx-state-store']['store-demo']</code></p>

        <p>To activate/deactivate log and timekeeping at runtime: </p>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
window['ngx-state-store']['store-demo'].state.log.log = true;
window['ngx-state-store']['store-demo'].state.performance.timekeeping = true;
            </code>
            </pre></div></div>

        <h5 id="14-create-an-action">1.4. Create an action.</h5>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span><span class="p">,</span> <span class="nx">StateContext</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionIds</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../action-ids</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../app-state</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">IncrementCounterAction</span> <span
                        class="kd">extends</span> <span class="nx">Action</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">ActionIds</span><span class="p">.</span><span
                        class="nx">UpdateCounter</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handleState</span><span class="p">(</span><span class="nx">stateContext</span><span class="p">:</span> <span class="nx">StateContext</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newValue</span> <span class="o">=</span> <span
                        class="k">this</span><span class="p">.</span><span class="nx">getEmptyState</span><span
                        class="p">();</span>
    <span class="nx">newValue</span><span class="p">.</span><span class="nx">Counter</span> <span
                        class="o">=</span> <span class="nx">stateContext</span><span class="p">.</span><span class="nx">getState</span><span
                        class="p">().</span><span class="nx">Counter</span> <span class="o">+</span> <span
                        class="mi">1</span><span class="p">;</span>
    <span class="nx">stateContext</span><span class="p">.</span><span class="nx">patchState</span><span
                        class="p">(</span><span class="nx">newValue</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span
                    class="kr">enum</span> <span class="nx">ActionIds</span> <span class="p">{</span>
    <span class="nx">UpdateCounter</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">[Common] update counter</span><span class="dl">'</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <p>The ids, like one above - <code class="language-plaintext highlighter-rouge">[Common] update counter</code>,
            will be displayed in the console log output</p>

        <h5 id="15-create-an-action-factory">1.5. Create an action factory.</h5>
        <p>Example: src/app/services/state-store/action-factory.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span
                    class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">IncrementCounterAction</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">./actions/increment-counter.action</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ActionFactory</span> <span class="p">{</span>

  <span class="nx">incrementCounter</span><span class="p">():</span> <span class="nx">Action</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">IncrementCounterAction</span><span
                        class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="16-to-update-the-state-call-the-storedispatch">1.6. To update the state call the <code
                class="language-plaintext highlighter-rouge">store.dispatch(...)</code>.</h5>
        <p>Example: src/app/components/counter-button.component/counter-button.component.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span
                    class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/app-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">ActionFactory</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/action-factory</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Store</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">app-counter-button</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./counter-button.component.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">./counter-button.component.scss</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CounterButtonComponent</span> <span
                        class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">,</span>
              <span class="kr">private</span> <span class="nx">factory</span><span class="p">:</span> <span class="nx">ActionFactory</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">incrementCounter</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span
                        class="nx">dispatch</span><span class="p">(</span><span class="k">this</span><span
                        class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="nx">incrementCounter</span><span
                        class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="17-to-subscribe-to-some-state-use-storeselect">1.7. To subscribe to some state use <code
                class="language-plaintext highlighter-rouge">store.select(...)</code>.</h5>
        <p>Example: src/app/components/counter.component/counter.component.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Store</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/app-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">app-counter</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./counter.component.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">./counter.component.scss</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CounterComponent</span> <span class="kr">implements</span> <span
                        class="nx">OnInit</span> <span class="p">{</span>

  <span class="nx">counter$</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">ngOnInit</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">counter$</span> <span class="o">=</span> <span
                        class="k">this</span><span class="p">.</span><span class="nx">store</span><span
                        class="p">.</span><span class="nx">select</span><span class="p">(</span><span
                        class="dl">'</span><span class="s1">Counter</span><span class="dl">'</span><span
                        class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <p>The <code class="language-plaintext highlighter-rouge">select(...)</code> method returns an Observable.</p>

        <h3 id="2-more-complex-use-case-with-the-back-end-call">2. More complex use case with the back-end call.</h3>

        <p>For the more complex use case with the back-end call refer to the source code:</p>

        <ul>
            <li>src/app/components/inventories-button.component/inventories-button.component.ts</li>
            <li>src/app/components/inventories.component/inventories.component.ts</li>
            <li>src/app/services/state-store/actions/load-inventories.action.ts</li>
            <li>src/app/services/connectors/inventory.connector.ts</li>
        </ul>

        <h5 id="21-extend-the-state-object">2.1. Extend the state object.</h5>
        <p>Example: src/app/services/state-store/app-state.ts<br/>
            Example: src/app/models/inventory.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Inventory</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">../../models/inventory</span><span class="dl">'</span><span
                    class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppState</span> <span class="p">{</span>
  <span class="nl">ShowLoadingIndicator</span><span class="p">:</span> <span class="nx">string</span><span class="p">[];</span>
  <span class="nl">Counter</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nl">Inventories</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[];</span>
  <span class="c1">// iso Date string</span>
  <span class="nl">LastDownloadAt</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span
                    class="kd">class</span> <span class="nx">Inventory</span> <span class="p">{</span>
  <span class="nl">id</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nl">version</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="22-extend-the-initial-state-object">2.2. Extend the initial state object.</h5>
        <p>Example: src/app/services/state-store/app-initial-state.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">./app-state</span><span class="dl">'</span><span
                    class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">AppInitialState</span><span
                        class="p">:</span> <span class="nx">AppState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">ShowLoadingIndicator</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">Counter</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="na">Inventories</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="na">LastDownloadAt</span><span class="p">:</span> <span class="dl">''</span>
<span class="p">};</span>
</code></pre>
            </div>
        </div>

        <h5 id="23-create-new-actions">2.3. Create new actions.</h5>
        <p>Example: src/app/services/state-store/actions/show-loading-indicator.action.ts<br/>
            Example: src/app/services/state-store/actions/hide-loading-indicator.action.ts<br/>
            Example: src/app/services/state-store/actions/load-inventories.action.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span><span class="p">,</span> <span class="nx">StateContext</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionIds</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../action-ids</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../app-state</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ShowLoadingIndicatorAction</span> <span
                        class="kd">extends</span> <span class="nx">Action</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">identifier</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">ActionIds</span><span class="p">.</span><span
                        class="nx">ShowLoadingIndicator</span> <span class="o">+</span> <span class="dl">'</span><span
                        class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">identifier</span><span
                        class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handleState</span><span class="p">(</span><span class="nx">stateContext</span><span class="p">:</span> <span class="nx">StateContext</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span
                        class="k">this</span><span class="p">.</span><span class="nx">getEmptyState</span><span
                        class="p">();</span>
    <span class="nx">newState</span><span class="p">.</span><span class="nx">ShowLoadingIndicator</span>
        <span class="o">=</span> <span class="nx">stateContext</span><span class="p">.</span><span
                        class="nx">getState</span><span class="p">().</span><span class="nx">ShowLoadingIndicator</span><span
                        class="p">.</span><span class="nx">slice</span><span class="p">();</span>
    <span class="nx">newState</span><span class="p">.</span><span class="nx">ShowLoadingIndicator</span><span class="p">.</span><span
                        class="nx">push</span><span class="p">(</span><span class="k">this</span><span
                        class="p">.</span><span class="nx">identifier</span><span class="p">);</span>
    <span class="nx">stateContext</span><span class="p">.</span><span class="nx">patchState</span><span
                        class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span><span class="p">,</span> <span class="nx">StateContext</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionIds</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../action-ids</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../app-state</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">HideLoadingIndicatorAction</span> <span
                        class="kd">extends</span> <span class="nx">Action</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">identifier</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">ActionIds</span><span class="p">.</span><span
                        class="nx">HideLoadingIndicator</span> <span class="o">+</span> <span class="dl">'</span><span
                        class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">identifier</span><span
                        class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handleState</span><span class="p">(</span><span class="nx">stateContext</span><span class="p">:</span> <span class="nx">StateContext</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">stateContext</span><span class="p">.</span><span
                        class="nx">getState</span><span class="p">().</span><span class="nx">ShowLoadingIndicator</span> <span
                        class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span
                        class="nx">stateContext</span><span class="p">.</span><span class="nx">getState</span><span
                        class="p">()</span>
                    <span class="p">.</span><span class="nx">ShowLoadingIndicator</span><span class="p">.</span><span
                        class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span
                        class="p">.</span><span class="nx">identifier</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&lt;</span> <span
                        class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="na">newState</span><span class="p">:</span> <span
                        class="nx">AppState</span> <span class="o">=</span> <span class="k">this</span><span
                        class="p">.</span><span class="nx">getEmptyState</span><span class="p">();</span>
    <span class="nx">newState</span><span class="p">.</span><span class="nx">ShowLoadingIndicator</span>
        <span class="o">=</span> <span class="nx">stateContext</span><span class="p">.</span><span
                        class="nx">getState</span><span class="p">().</span><span class="nx">ShowLoadingIndicator</span><span
                        class="p">.</span><span class="nx">slice</span><span class="p">();</span>
    <span class="nx">newState</span><span class="p">.</span><span class="nx">ShowLoadingIndicator</span><span class="p">.</span><span
                        class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span
                        class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">stateContext</span><span class="p">.</span><span class="nx">patchState</span><span
                        class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span><span class="p">,</span> <span class="nx">StateContext</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionIds</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../action-ids</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../app-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">InventoryConnector</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../connectors/inventory.connector</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">tap</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs/operators</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">LoadInventoriesAction</span> <span
                        class="kd">extends</span> <span class="nx">Action</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">inventoryConnector</span><span class="p">:</span> <span class="nx">InventoryConnector</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">ActionIds</span><span class="p">.</span><span
                        class="nx">LoadInventories</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handleState</span><span class="p">(</span><span class="nx">stateContext</span><span class="p">:</span> <span class="nx">StateContext</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span
                        class="nx">inventoryConnector</span><span class="p">.</span><span
                        class="nx">loadInventory</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
        <span class="nx">tap</span><span class="p">(</span><span class="nx">inventories</span> <span
                        class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="na">newState</span><span class="p">:</span> <span class="nx">AppState</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getEmptyState</span><span class="p">();</span>
          <span class="nx">newState</span><span class="p">.</span><span class="nx">Inventories</span> <span class="o">=</span> <span class="nx">inventories</span><span class="p">;</span>
          <span class="nx">newState</span><span class="p">.</span><span class="nx">LastDownloadAt</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">toISOString</span><span class="p">();</span>
          <span class="nx">stateContext</span><span class="p">.</span><span class="nx">patchState</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
        <span class="p">})</span>
      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="24-extend-the-action-factory-and-create-the-connector">2.4. Extend the action factory and create the
            connector.</h5>
        <p>Example: src/app/services/state-store/action-factory.ts<br/>
            Example: src/app/services/connectors/inventory.connector.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span
                    class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">HttpClient</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">@angular/common/http</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Inventory</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span
                        class="s1">../../models/inventory</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">delay</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs/operators</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">InventoryConnector</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">http</span><span class="p">:</span> <span class="nx">HttpClient</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">loadInventory</span><span class="p">():</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">Inventory</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// delay(2000) to imitate the network throttling</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span
                        class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">Inventory</span><span
                        class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span
                        class="dl">'</span><span class="s1">assets/mock-data/inventories.json</span><span
                        class="dl">'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span
                        class="nx">delay</span><span class="p">(</span><span class="mi">2000</span><span
                        class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span
                    class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span
                    class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Action</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">ShowLoadingIndicatorAction</span> <span class="p">}</span> <span class="k">from</span> <span
                        class="dl">'</span><span class="s1">./actions/show-loading-indicator.action</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">IncrementCounterAction</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">./actions/increment-counter.action</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">HideLoadingIndicatorAction</span> <span class="p">}</span> <span class="k">from</span> <span
                        class="dl">'</span><span class="s1">./actions/hide-loading-indicator.action</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">LoadInventoriesAction</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">./actions/load-inventories.action</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">InventoryConnector</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../connectors/inventory.connector</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">enum</span> <span class="nx">LoadIndicator</span> <span class="p">{</span>
  <span class="nx">DEFAULT</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">DEFAULT</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">LOAD_INVENTORIES</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">LOAD_INVENTORIES</span><span class="dl">'</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ActionFactory</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">inventoryConnector</span><span class="p">:</span> <span class="nx">InventoryConnector</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">incrementCounter</span><span class="p">():</span> <span class="nx">Action</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">IncrementCounterAction</span><span
                        class="p">();</span>
  <span class="p">}</span>

  <span class="nx">showLoadIndicator</span><span class="p">(</span><span class="nx">identifier</span><span class="p">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">LoadIndicator</span><span class="p">.</span><span class="nx">DEFAULT</span><span class="p">):</span> <span class="nx">Action</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">ShowLoadingIndicatorAction</span><span
                        class="p">(</span><span class="nx">identifier</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">hideLoadIndicator</span><span class="p">(</span><span class="nx">identifier</span><span class="p">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">LoadIndicator</span><span class="p">.</span><span class="nx">DEFAULT</span><span class="p">):</span> <span class="nx">Action</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">HideLoadingIndicatorAction</span><span
                        class="p">(</span><span class="nx">identifier</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">loadInventories</span><span class="p">():</span> <span class="nx">Action</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">LoadInventoriesAction</span><span
                        class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inventoryConnector</span><span
                        class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="25-to-load-the-data-from-back-end-and-update-the-states-call-the-storedispatch">2.5. To load the data
            from back-end and update the states call the <code class="language-plaintext highlighter-rouge">store.dispatch(...)</code>.
        </h5>
        <p>Example: src/app/components/inventories-button.component/inventories-button.component.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Store</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/app-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">ActionFactory</span><span class="p">,</span> <span class="nx">LoadIndicator</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/action-factory</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">catchError</span><span class="p">,</span> <span class="nx">flatMap</span><span class="p">,</span> <span class="nx">skip</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs/operators</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="k">of</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Inventory</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span
                        class="s1">../../models/inventory</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">Changes</span> <span class="p">{</span>
  <span class="nl">addedEntries</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[];</span>
  <span class="nl">removedEntries</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[];</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">app-inventories-button</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./inventories-button.component.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">./inventories-button.component.scss</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">InventoriesButtonComponent</span> <span
                        class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>

  <span class="nl">lastDownloadAt</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">changes</span><span class="p">:</span> <span class="nx">Changes</span> <span class="o">=</span> <span class="p">{</span><span
                        class="na">addedEntries</span><span class="p">:</span> <span class="p">[],</span> <span
                        class="na">removedEntries</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">as</span> <span class="nx">Changes</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">,</span>
              <span class="kr">private</span> <span class="nx">factory</span><span class="p">:</span> <span class="nx">ActionFactory</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">ngOnInit</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span
                        class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">Inventories</span><span
                        class="dl">'</span><span class="p">,</span>
      <span class="p">(</span><span class="na">oldInventories</span><span class="p">:</span> <span
                        class="nx">Inventory</span><span class="p">[],</span> <span
                        class="na">newInventories</span><span class="p">:</span> <span class="nx">Inventory</span><span
                        class="p">[])</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oldInventories</span> <span class="o">===</span> <span class="nx">newInventories</span>
          <span class="o">||</span> <span class="nx">oldInventories</span> <span class="o">&amp;&amp;</span> <span class="nx">newInventories</span>
          <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">calcDiff</span><span class="p">(</span><span class="nx">oldInventories</span><span class="p">,</span> <span class="nx">newInventories</span><span class="p">).</span><span class="nx">length</span>
          <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">calcDiff</span><span class="p">(</span><span class="nx">newInventories</span><span class="p">,</span> <span class="nx">oldInventories</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">changes</span><span class="p">.</span><span class="nx">addedEntries</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calcDiff</span><span class="p">(</span><span class="nx">oldInventories</span><span class="p">,</span> <span class="nx">newInventories</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">changes</span><span class="p">.</span><span class="nx">removedEntries</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calcDiff</span><span class="p">(</span><span class="nx">newInventories</span><span class="p">,</span> <span class="nx">oldInventories</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">skip</span><span
                        class="p">(</span><span class="mi">1</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">subscribe</span><span class="p">(()</span> <span
                        class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">the log is present only if there are some changes</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="kr">private</span> <span class="nx">calcDiff</span><span class="p">(</span><span class="na">source</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[],</span> <span class="na">target</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[]):</span> <span class="nx">Inventory</span><span class="p">[]</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">target</span> <span class="o">||</span> <span
                        class="p">[]).</span><span class="nx">filter</span><span class="p">(</span><span
                        class="nx">t</span> <span class="o">=&gt;</span> <span class="o">!</span><span
                        class="p">(</span><span class="nx">source</span> <span class="o">||</span> <span
                        class="p">[]).</span><span class="nx">find</span><span class="p">(</span><span
                        class="nx">s</span> <span class="o">=&gt;</span> <span class="nx">s</span><span
                        class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span
                        class="nx">t</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="nx">loadInventory</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changes</span><span class="p">.</span><span
                        class="nx">addedEntries</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changes</span><span class="p">.</span><span
                        class="nx">removedEntries</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span
                        class="nx">dispatch</span><span class="p">(</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span
                        class="nx">showLoadIndicator</span><span class="p">(</span><span class="nx">LoadIndicator</span><span
                        class="p">.</span><span class="nx">LOAD_INVENTORIES</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
            <span class="nx">flatMap</span><span class="p">(()</span> <span class="o">=&gt;</span> <span
                        class="k">this</span><span class="p">.</span><span class="nx">store</span><span
                        class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span
                        class="k">this</span><span class="p">.</span><span class="nx">factory</span><span
                        class="p">.</span><span class="nx">loadInventories</span><span class="p">())),</span>
            <span class="nx">catchError</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span
                        class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">of</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">).</span><span class="nx">subscribe</span><span class="p">((</span><span class="na">state</span><span
                        class="p">:</span> <span class="nx">AppState</span><span class="p">)</span> <span class="o">=&gt;</span> <span
                        class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">lastDownloadAt</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">LastDownloadAt</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="nx">hideLoadIndicator</span><span class="p">(</span><span class="nx">LoadIndicator</span><span class="p">.</span><span class="nx">LOAD_INVENTORIES</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">inventoriesToString</span><span class="p">(</span><span class="na">inventories</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[]):</span> <span class="nx">string</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">inventories</span><span class="p">.</span><span class="nx">map</span><span
                        class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span
                        class="nx">e</span><span class="p">.</span><span class="nx">id</span><span
                        class="p">).</span><span class="nx">toString</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <h5 id="26-to-subscribe-to-the-new-states-use-storeselect">2.6. To subscribe to the new states use <code
                class="language-plaintext highlighter-rouge">store.select(...)</code>.</h5>
        <p>Example: src/app/components/inventories.component/inventories.component.ts</p>

        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span
                    class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span
                    class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Store</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">ngx-state-store</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppState</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/app-state</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Inventory</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span
                        class="s1">../../models/inventory</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">Observable</span><span class="p">,</span> <span class="k">of</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">flatMap</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">rxjs/operators</span><span
                        class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{
                    </span> <span class="nx">LoadIndicator</span> <span class="p">}</span> <span
                        class="k">from</span> <span class="dl">'</span><span class="s1">../../services/state-store/action-factory</span><span
                        class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">app-inventories</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./inventories.component.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">./inventories.component.scss</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">InventoriesComponent</span> <span
                        class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>

  <span class="nl">inventories</span><span class="p">:</span> <span class="nx">Inventory</span><span class="p">[];</span>
  <span class="nx">loading$</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">AppState</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">ngOnInit</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loading$</span> <span class="o">=</span> <span
                        class="k">this</span><span class="p">.</span><span class="nx">store</span><span
                        class="p">.</span><span class="nx">select</span><span class="p">(</span><span
                        class="dl">'</span><span class="s1">ShowLoadingIndicator</span><span class="dl">'</span><span
                        class="p">).</span><span class="nx">pipe</span><span class="p">(</span>
      <span class="nx">flatMap</span><span class="p">(</span><span class="nx">indicators</span> <span
                        class="o">=&gt;</span>
        <span class="k">of</span><span class="p">(</span><span class="nx">indicators</span><span class="p">.</span><span
                        class="nx">filter</span><span class="p">(</span><span class="nx">i</span> <span
                        class="o">=&gt;</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">LoadIndicator</span><span
                        class="p">.</span><span class="nx">LOAD_INVENTORIES</span><span class="p">).</span><span
                        class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span
                        class="p">))</span>
    <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span
                        class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">Inventories</span><span
                        class="dl">'</span><span class="p">).</span><span class="nx">subscribe</span><span
                        class="p">(</span><span class="nx">inventories</span> <span class="o">=&gt;</span> <span
                        class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">inventories</span> <span class="o">=</span> <span class="nx">inventories</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
            </div>
        </div>

        <p>The observables returned from the <code class="language-plaintext highlighter-rouge">store.select(...)</code>
            return a frozen (read only)
            state objects that were frozen by the <code class="language-plaintext highlighter-rouge">StateHelper.deepFreeze(any)</code>.
            Use <code class="language-plaintext highlighter-rouge">StateHelper.cloneObject(any, cloneFunctions =
                true)</code> to get a clone of the frozen object including functions (default) if it is needed.</p>

        <p>Keep in mind that all objects passed to the state store will be frozen.</p>

        <h3 id="3-api-overview">3. API overview.</h3>

        <h5 id="31-store">3.1. Store.</h5>

        <ul>
            <li><code class="language-plaintext highlighter-rouge">select(string, ObjectComparator?): Observable&lt;any&gt;</code>
                - select some state of the state store, <code class="language-plaintext highlighter-rouge">ObjectComparator</code>
                is
                optional, can be used to implement more advanced comparison of the potential changes. It is also
                convenient way
                to only subscribe to some property/properties changes of some state object.
            </li>
            <li><code class="language-plaintext highlighter-rouge">selectOnce(string): Observable&lt;any&gt;</code> -
                the same as <code class="language-plaintext highlighter-rouge">select</code> but the Observable is
                complete after forward one value
            </li>
            <li><code class="language-plaintext highlighter-rouge">dispatch(action: Action): Observable&lt;state:
                S&gt;</code> - dispatch the Action that changes some state, the dispatch function
                always returns an Observable of your state
            </li>
        </ul>

        <p><strong>Tip</strong>: you could join many dispatch calls in a pipe and have access to the last state change
            from the previous call,
            in this case your actions must do your changes of the state by returning an Observable,
            the return value of the Observable does not have any meaning, just use <code
                    class="language-plaintext highlighter-rouge">return of(null);</code> from rxjs, or operator function
            <code class="language-plaintext highlighter-rouge">tap((x: T) =&gt; void)</code><br/>
            see example: <code class="language-plaintext highlighter-rouge">inventories-button.component.ts</code> and
            <code class="language-plaintext highlighter-rouge">load-inventories.action.ts</code><br/>
            in the example <code class="language-plaintext highlighter-rouge">load-inventories.action.ts</code> the
            access to the <code class="language-plaintext highlighter-rouge">&lt;state: S&gt;</code> is in the
            subscription.</p>

        <p><em>Pseudo code example:</em></p>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span
                    class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span
                    class="p">(</span><span class="o">&lt;</span><span class="nx">some</span> <span
                    class="nx">action</span><span class="o">&gt;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">flatMap</span><span class="p">((</span><span class="nx">state</span><span class="p">:</span> <span
                        class="nx">S</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// ... read and use data from the state</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">another</span> <span class="nx">action</span><span class="o">&gt;</span><span class="p">);</span>
    <span class="p">}),</span>
    <span class="nx">flatMap</span><span class="p">((</span><span class="na">state</span><span class="p">:</span> <span
                        class="nx">S</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// ... read and use data from the state</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">another</span> <span class="nx">action</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">);</span>
    <span class="p">})</span>
  <span class="p">).</span><span class="nx">subscribe</span><span class="p">((</span><span class="na">state</span><span
                        class="p">:</span> <span class="nx">S</span><span class="p">)</span> <span
                        class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ... read and use data from the state</span>
  <span class="p">});</span>
</code></pre>
            </div>
        </div>

        <h5 id="311-objectcomparator">3.1.1. ObjectComparator.</h5>

        <p><code class="language-plaintext highlighter-rouge">export type ObjectComparator = (oldObject: any, newObject:
            any) =&gt; boolean;</code> - is a function.<br/>
            The ObjectComparator can be used by <code class="language-plaintext highlighter-rouge">Store#select(string,
                ObjectComparator?): Observable&lt;any&gt;</code> as second parameter.
            By the ObjectComparator you may implement more advanced comparison of the potential changes.</p>

        <p>The method must return <code class="language-plaintext highlighter-rouge">true</code> if there are no changes
            you are interested in. For example the property/properties of some state object
            was/were not changed.</p>

        <p><em>Pseudo code example:</em></p>
        <div class="language-typescript highlighter-rouge">
            <div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span
                    class="nx">store</span><span class="p">.</span><span class="nx">select</span><span
                    class="p">(</span><span class="dl">'</span><span class="s1">&lt;some state&gt;</span><span
                    class="dl">'</span><span class="p">,</span> <span class="p">(</span><span
                    class="nx">oldObjectState</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span
                    class="nx">newObjectState</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span
                    class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// here you can compare if the value of some property was changed</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">oldObjectState</span> <span class="o">===</span> <span class="nx">newObjectState</span> <span class="o">||</span> <span class="nx">oldObjectState</span> <span class="o">&amp;&amp;</span> <span class="nx">newObjectState</span>
            <span class="o">&amp;&amp;</span> <span class="nx">oldObjectState</span><span class="p">[</span><span class="dl">'</span><span class="s1">someProperty</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="nx">newObjectState</span><span class="p">[</span><span class="dl">'</span><span class="s1">someProperty</span><span class="dl">'</span><span class="p">])</span> <span class="p">{</span>
       <span class="c1">// nothing changed</span>
       <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// someProperty of the state object was changed</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">subscribe</span><span class="p">((</span><span class="na">state</span><span
                        class="p">:</span> <span class="nx">S</span><span class="p">)</span> <span
                        class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ... do somethig if the newObjectState partly changed</span>
  <span class="p">});</span>
</code></pre>
            </div>
        </div>

        <h5 id="32-statehelper">3.2. StateHelper.</h5>

        <ul>
            <li><code class="language-plaintext highlighter-rouge">static deepFreeze&lt;T&gt;(o: T): T</code> - freezes
                the object, the object is read only after the call
            </li>
            <li><code class="language-plaintext highlighter-rouge">static cloneObject&lt;T&gt;(o: T, cloneFunctions =
                true): T</code> - creates a clone of the object including functions (default), it is useful if the
                object was frozen by the <code class="language-plaintext highlighter-rouge">deepFreeze</code></li>
        </ul>

        <h5 id="33-statecontext">3.3. StateContext.</h5>

        <ul>
            <li><code class="language-plaintext highlighter-rouge">getState(): S</code> - returns the whole current
                state
            </li>
            <li><code class="language-plaintext highlighter-rouge">patchState(val: Partial&lt;S&gt;)</code> - patch the
                existing state with the provided value
            </li>
            <li><code class="language-plaintext highlighter-rouge">setState(state: S)</code> - reset the whole state to
                a new value
            </li>
        </ul>

        <h5 id="34-action">3.4. Action.</h5>

        <ul>
            <li><code class="language-plaintext highlighter-rouge">abstract handleState(stateContext: StateContext&lt;any&gt;):
                Observable&lt;any&gt; | void</code> - it must be implemented by the user
            </li>
            <li><code class="language-plaintext highlighter-rouge">clone&lt;T&gt;(o: T, cloneFunctions = true): T</code>
                - clone the object including functions (default), the same as <code
                        class="language-plaintext highlighter-rouge">StateHelper.cloneObject(o, cloneFunctions =
                    true)</code></li>
        </ul>

        <h2 id="build-the-application">Build the application</h2>

        <p>Run <code class="language-plaintext highlighter-rouge">ng build</code> to build the project. The build
            artifacts will be stored in the <code class="language-plaintext highlighter-rouge">dist/</code> directory.
        </p>

        <h2 id="running-the-development-server">Running the development server</h2>

        <p>Run <code class="language-plaintext highlighter-rouge">ng serve</code> to start the app. The app is available
            at <a href="http://localhost:4200/">http://localhost:4200/</a>.</p>

        <h2 id="license">License</h2>
        <p><a href="https://choosealicense.com/licenses/mit/">MIT</a></p>

    </section>
</div>

<!-- FOOTER  -->
<div class="outer" id="footer_wrap">
    <footer class="inner">

        <p class="copyright">state-store maintained by <a href="https://github.com/it-and-services">it-and-services</a>
        </p>

        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>


</body>
</html>
